<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Firza Radio Medan</title>

<style>
/* ---------------- GLOBAL ---------------- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}

body{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:15px;
  background:linear-gradient(120deg,#ff512f,#dd2476);
  transition:background 2s ease;
}

.radio-player{
  width:100%;
  max-width:420px;
  background:rgba(255,255,255,0.08);
  border-radius:20px;
  backdrop-filter:blur(15px);
  box-shadow:0 10px 30px rgba(0,0,0,0.4);
  overflow:hidden;
  color:#fff;
  padding-bottom:20px;
}

/* HEADER */
.header{text-align:center;padding:15px}
.header h1{font-size:22px;margin-bottom:3px}
.header p{opacity:.7;font-size:13px}

/* ------------ ALBUM ART + GLOW ---------------- */
.album-wrap{
  width:240px;
  height:240px;
  margin:20px auto 10px;
  position:relative;
}

#cover{
  width:100%;height:100%;
  border-radius:20px;
  background-size:cover;
  background-position:center;
  box-shadow:0 15px 35px rgba(0,0,0,0.5);
}

/* ------------ TRACK INFO ------------- */
.track-info{text-align:center;padding:0 15px 15px}
#title{
  font-size:18px;font-weight:600;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
#artist{opacity:.85;font-size:14px;margin-top:3px}

/* Controls */
.controls{padding:12px}

.playback-controls{
  display:flex;
  justify-content:center;
  gap:25px;
  margin-bottom:10px;
}

.control-btn{
  width:50px;height:50px;
  border-radius:50%;
  border:none;
  font-size:22px;
  background:rgba(255,255,255,0.15);
  color:white;
  cursor:pointer;
  transition:.3s;
}
.control-btn:hover{background:rgba(255,255,255,0.25)}
.play-btn{width:68px;height:68px;font-size:30px}

/* VOLUME */
.volume-controls{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:15px;
}

.volume-slider{
  width:65%;
  -webkit-appearance:none;
  height:6px;
  border-radius:5px;
  background:rgba(255,255,255,0.3);
}
.volume-slider::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:18px;height:18px;
  border-radius:50%;
  background:white;
}

.footer{text-align:center;font-size:12px;opacity:.4;padding:10px}
</style>
</head>

<body>

<div class="radio-player" id="playerBox">

  <div class="header">
    <h1>Firza Radio Medan</h1>
    <p>More than the other</p>
  </div>

  <div class="album-wrap">
    <div id="cover"></div>
  </div>

  <div class="track-info">
    <div id="title">Memuat...</div>
    <div id="artist">Menunggu data...</div>
  </div>

  <div class="controls">
    <div class="playback-controls">
      <button class="control-btn" id="prevBtn">‚èÆ</button>
      <button class="control-btn play-btn" id="playButton"><span id="playIcon">‚ñ∂</span></button>
      <button class="control-btn" id="nextBtn">‚è≠</button>
    </div>

    <div class="volume-controls">
      üîä <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70">
    </div>
  </div>

  <div class="footer">¬© Firza Radio 2026</div>

</div>

<audio id="radio" src="https://stream.zeno.fm/49c2uvzd4reuv"></audio>

<script>
const id = "49c2uvzd4reuv";
const api = `https://zenoplay.zenomedia.com/api/zenofm/nowplaying/${id}`;
const defaultCover = "https://dpi4fupzvxbqq.cloudfront.net/rfm/uploads/blogo/300/300_1470024235.png";

const audio       = document.getElementById("radio");
const titleEl     = document.getElementById("title");
const artistEl    = document.getElementById("artist");
const coverEl     = document.getElementById("cover");
const playBtn     = document.getElementById("playButton");
const playIcon    = document.getElementById("playIcon");
const volumeSlider = document.getElementById("volumeSlider");
const playerBox    = document.getElementById("playerBox");

/* PLAY / PAUSE */
playBtn.onclick = () => {
  if (audio.paused) {
    audio.play();
    playIcon.textContent = "‚ùö‚ùö";
  } else {
    audio.pause();
    playIcon.textContent = "‚ñ∂";
  }
};

/* Volume */
volumeSlider.oninput = () => {
  audio.volume = volumeSlider.value / 100;
};

/* COLOR EXTRACTOR */
function extractColor(url, callback){
  const img = new Image();
  img.crossOrigin = "anonymous";
  img.src = url;
  img.onload = () => {
    const c = document.createElement("canvas");
    const x = c.getContext("2d");
    c.width = img.width;
    c.height = img.height;
    x.drawImage(img,0,0);
    const d = x.getImageData(0,0,c.width,c.height).data;
    let r=0,g=0,b=0,count=0;
    for(let i=0;i<d.length;i+=4){
      r+=d[i]; g+=d[i+1]; b+=d[i+2]; count++;
    }
    callback(`rgb(${~~(r/count)},${~~(g/count)},${~~(b/count)})`);
  };
}

/* iTunes Cover API */
async function getCover(artist, title) {
  try {
    const q = encodeURIComponent(`${artist} ${title}`);
    const res = await fetch(`https://itunes.apple.com/search?term=${q}&entity=song&limit=1`);
    const data = await res.json();
    if (data.results.length > 0) {
      return data.results[0].artworkUrl100.replace("100x100bb.jpg","600x600bb.jpg");
    }
  } catch {}
  return defaultCover;
}

// ----- Glow & average color -----
function applyGlow(){
  const img = coverImage;
  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");
  canvas.width = img.naturalWidth;
  canvas.height = img.naturalHeight;
  ctx.drawImage(img,0,0);

  const data = ctx.getImageData(0,0,canvas.width,canvas.height).data;
  let r=0,g=0,b=0,count=0;

  for(let i=0;i<data.length;i+=50){
    r += data[i]; g += data[i+1]; b += data[i+2]; count++;
  }

  r=Math.floor(r/count); g=Math.floor(g/count); b=Math.floor(b/count);

  coverGlow.style.background = `radial-gradient(circle, rgba(${r},${g},${b},0.7), transparent 70%)`;
  coverGlow.style.opacity = 1;
}

// ----- Background auto-change every 20‚Äì30 seconds -----
const bgSet = [
  ["#ff512f","#dd2476"],
  ["#1a2a6c","#b21f1f","#fdbb2d"],
  ["#00c6ff","#0072ff"],
  ["#7f00ff","#e100ff"],
  ["#ff9966","#ff5e62"]
];

function changeBG(){
  const bg = bgSet[Math.floor(Math.random()*bgSet.length)];
  document.body.style.background = `linear-gradient(120deg, ${bg.join(",")})`;
}

setInterval(changeBG, 25000);   // ~25 detik
changeBG();

/* Fetch Now Playing */
async function updateSong() {
  try {
    const res = await fetch(api);
    const data = await res.json();

    const text = data.title || "Live Stream";
    let artist = "";
    let title  = text;

    if (text.includes(" - ")) {
      artist = text.split(" - ")[0].trim();
      title  = text.split(" - ")[1].trim();
    }

    titleEl.textContent = title;
    artistEl.textContent = artist;

    const cover = await getCover(artist, title);
    coverEl.style.backgroundImage = `url("${cover}")`;

    extractColor(cover, (color)=> setGlow(color));

  } catch(e) {
    titleEl.textContent = "Radio Stream";
    coverEl.style.backgroundImage = `url("${defaultCover}")`;
    setGlow("cyan");
  }
}

updateSong();
setInterval(updateSong, 20000);
</script>

</body>
</html>
